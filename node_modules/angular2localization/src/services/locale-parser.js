/**
 * ANGULAR 2 LOCALIZATION
 * An Angular 2 library to translate messages, dates and numbers.
 * Written by Roberto Simonetti.
 * MIT license.
 * https://github.com/robisim74/angular2localization
 */
"use strict";
var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var lang_1 = require('@angular/common/src/facade/lang');
var exceptions_1 = require('@angular/common/src/facade/exceptions');
var intl_1 = require('@angular/common/src/facade/intl');
// Services.
var locale_number_1 = require('./locale-number');
var Intl_support_1 = require('./Intl-support');
/**
 * LocaleParser class.
 *
 * @author Roberto Simonetti
 */
var LocaleParser = (function () {
    function LocaleParser() {
    }
    /**
     * Builds the regular expression for the default locale.
     *
     * @param defaultLocale The default locale
     * @param digits The digit info: {minIntegerDigits}.{minFractionDigits}-{maxFractionDigits}
     * @return A RegExp object
     */
    LocaleParser.NumberRegExpFactory = function (defaultLocale, digits) {
        // Gets digits.
        var minInt = 1;
        var minFraction = 0;
        var maxFraction = 3;
        var re = lang_1.RegExpWrapper.create('^(\\d+)?\\.((\\d+)(\\-(\\d+))?)?$');
        if (lang_1.isPresent(digits)) {
            var parts = lang_1.RegExpWrapper.firstMatch(re, digits);
            if (lang_1.isBlank(parts)) {
                throw new exceptions_1.BaseException(digits + " is not a valid digit info for number");
            }
            if (lang_1.isPresent(parts[1])) {
                minInt = lang_1.NumberWrapper.parseIntAutoRadix(parts[1]);
            }
            if (lang_1.isPresent(parts[3])) {
                minFraction = lang_1.NumberWrapper.parseIntAutoRadix(parts[3]);
            }
            if (lang_1.isPresent(parts[5])) {
                maxFraction = lang_1.NumberWrapper.parseIntAutoRadix(parts[5]);
            }
        }
        // Converts numbers & signs to Unicode by default locale.
        var codes = new DecimalCode(defaultLocale);
        var minusSign = codes.minusSign;
        var zero = codes.numbers[0];
        var decimalSeparator = codes.decimalSeparator;
        var nine = codes.numbers[9];
        // Pattern for 1.2-2 digits: /^-?[0-9]{1,}\.[0-9]{2,2}$/
        // Unicode pattern = "^\u002d?[\u0030-\u0039]{1,}\\u002e[\u0030-\u0039]{2,2}$";
        var pattern;
        if (minFraction > 0 && maxFraction > 0) {
            pattern = "^"
                + minusSign
                + "?[" + zero + "-" + nine
                + "]{" + minInt + ",}\\"
                + decimalSeparator
                + "[" + zero + "-" + nine
                + "]{" + minFraction + "," + maxFraction
                + "}$";
        }
        else if (minFraction == 0 && maxFraction > 0) {
            // Decimal separator is optional.
            pattern = "^"
                + minusSign
                + "?[" + zero + "-" + nine
                + "]{" + minInt + ",}\\"
                + decimalSeparator
                + "?[" + zero + "-" + nine
                + "]{" + minFraction + "," + maxFraction
                + "}$";
        }
        else {
            // Integer number.
            pattern = pattern = "^"
                + minusSign
                + "?[" + zero + "-" + nine
                + "]{" + minInt + ",}$";
        }
        pattern = eval("'" + pattern + "'");
        var regExp = new RegExp(pattern);
        return regExp;
        // Wonderful, it works!
    };
    /**
     * Parses a string and returns a number by default locale.
     *
     * @param s The string to be parsed
     * @param defaultLocale The default locale
     * @return A number. If the string cannot be converted to a number, returns NaN
     */
    LocaleParser.Number = function (s, defaultLocale) {
        if (s == '' || defaultLocale == '' || defaultLocale == null)
            return null;
        var codes = new DecimalCode(defaultLocale);
        return codes.parse(s);
    };
    return LocaleParser;
}());
exports.LocaleParser = LocaleParser;
/**
 * NumberCode abstract superclass.
 *
 * Converts numbers to Unicode by locales.
 *
 * @author Roberto Simonetti
 */
var NumberCode = (function () {
    function NumberCode(defaultLocale) {
        this.defaultLocale = defaultLocale;
        /**
         * Unicode for numbers from 0 to 9.
         */
        this.numbers = [];
        for (var i = 0; i <= 9; i++) {
            this.numbers.push(this.Unicode(i.toString()));
        }
        // Checks for support for Intl.
        if (Intl_support_1.IntlSupport.NumberFormat(defaultLocale) == true) {
            // Updates Unicode for numbers by default locale.
            for (var i = 0; i <= 9; i++) {
                this.numbers[i] = this.Unicode(locale_number_1.LocaleNumber.format(defaultLocale, i, intl_1.NumberFormatStyle.Decimal, '1.0-0'));
            }
        }
    }
    NumberCode.prototype.Unicode = function (c) {
        return "\\u" + this.HexEncode(c.charCodeAt(0));
    };
    NumberCode.prototype.HexEncode = function (value) {
        var hex = value.toString(16).toUpperCase();
        // With padding.
        hex = "0000".substr(0, 4 - hex.length) + hex;
        return hex;
    };
    return NumberCode;
}());
/**
 * DecimalCode class.
 *
 * Converts numbers & signs to Unicode by locales.
 *
 * @author Roberto Simonetti
 */
var DecimalCode = (function (_super) {
    __extends(DecimalCode, _super);
    function DecimalCode(defaultLocale) {
        _super.call(this, defaultLocale);
        this.defaultLocale = defaultLocale;
        this.minusSign = this.Unicode("-");
        this.decimalSeparator = this.Unicode(".");
        // Checks for support for Intl.
        if (Intl_support_1.IntlSupport.NumberFormat(defaultLocale) == true) {
            // Updates Unicode for signs by default locale.
            var value = -0.9; // Reference value.
            var localeValue = locale_number_1.LocaleNumber.format(defaultLocale, value, intl_1.NumberFormatStyle.Decimal, '1.1-1');
            // Checks Unicode character 'RIGHT-TO-LEFT MARK' (U+200F).
            var index;
            if (this.Unicode(localeValue.charAt(0)) != "\\u200F") {
                // Left to right.
                index = 0;
            }
            else {
                // Right to left.
                index = 1;
            }
            this.minusSign = this.Unicode(localeValue.charAt(index));
            this.decimalSeparator = this.Unicode(localeValue.charAt(index + 2));
        }
    }
    DecimalCode.prototype.parse = function (s) {
        // Splits the String object into an array of characters.
        var characters = s.split('');
        // Builds the value.
        var value = "";
        for (var _i = 0, characters_1 = characters; _i < characters_1.length; _i++) {
            var char = characters_1[_i];
            var charCode = this.Unicode(char);
            // Try to look for the char code in numbers and signs.
            var index = this.numbers.indexOf(charCode);
            if (index != -1) {
                value += index;
            }
            else if (charCode == this.minusSign) {
                value += "-";
            }
            else if (charCode == this.decimalSeparator) {
                value += ".";
            }
            else {
                return NaN;
            }
        }
        return parseFloat(value);
    };
    return DecimalCode;
}(NumberCode));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9jYWxlLXBhcnNlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImxvY2FsZS1wYXJzZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7OztHQU1HOzs7Ozs7O0FBRUgscUJBQStELGlDQUFpQyxDQUFDLENBQUE7QUFDakcsMkJBQTRCLHVDQUF1QyxDQUFDLENBQUE7QUFDcEUscUJBQWdDLGlDQUFpQyxDQUFDLENBQUE7QUFFbEUsWUFBWTtBQUNaLDhCQUEyQixpQkFBaUIsQ0FBQyxDQUFBO0FBQzdDLDZCQUEwQixnQkFBZ0IsQ0FBQyxDQUFBO0FBRTNDOzs7O0dBSUc7QUFDSDtJQUVJO0lBQWdCLENBQUM7SUFFakI7Ozs7OztPQU1HO0lBQ0ksZ0NBQW1CLEdBQTFCLFVBQTJCLGFBQXFCLEVBQUUsTUFBYztRQUU1RCxlQUFlO1FBQ2YsSUFBSSxNQUFNLEdBQVcsQ0FBQyxDQUFDO1FBQ3ZCLElBQUksV0FBVyxHQUFXLENBQUMsQ0FBQztRQUM1QixJQUFJLFdBQVcsR0FBVyxDQUFDLENBQUM7UUFDNUIsSUFBSSxFQUFFLEdBQVcsb0JBQWEsQ0FBQyxNQUFNLENBQUMsbUNBQW1DLENBQUMsQ0FBQztRQUUzRSxFQUFFLENBQUMsQ0FBQyxnQkFBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUVwQixJQUFJLEtBQUssR0FBRyxvQkFBYSxDQUFDLFVBQVUsQ0FBQyxFQUFFLEVBQUUsTUFBTSxDQUFDLENBQUM7WUFFakQsRUFBRSxDQUFDLENBQUMsY0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDakIsTUFBTSxJQUFJLDBCQUFhLENBQUksTUFBTSwwQ0FBdUMsQ0FBQyxDQUFDO1lBQzlFLENBQUM7WUFDRCxFQUFFLENBQUMsQ0FBQyxnQkFBUyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDdEIsTUFBTSxHQUFHLG9CQUFhLENBQUMsaUJBQWlCLENBQUMsS0FBSyxD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QUFFLENBQUMsQ0FBQyxRQUFRLElBQUksSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQztnQkFFM0MsS0FBSyxJQUFJLEdBQUcsQ0FBQztZQUVqQixDQUFDO1lBQUMsSUFBSSxDQUFDLENBQUM7Z0JBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQztZQUFDLENBQUM7U0FFekI7UUFFRCxNQUFNLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBRTdCLENBQUM7SUFFTCxrQkFBQztBQUFELENBQUMsQUE1RUQsQ0FBMEIsVUFBVSxHQTRFbkMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQU5HVUxBUiAyIExPQ0FMSVpBVElPTlxyXG4gKiBBbiBBbmd1bGFyIDIgbGlicmFyeSB0byB0cmFuc2xhdGUgbWVzc2FnZXMsIGRhdGVzIGFuZCBudW1iZXJzLlxyXG4gKiBXcml0dGVuIGJ5IFJvYmVydG8gU2ltb25ldHRpLlxyXG4gKiBNSVQgbGljZW5zZS5cclxuICogaHR0cHM6Ly9naXRodWIuY29tL3JvYmlzaW03NC9hbmd1bGFyMmxvY2FsaXphdGlvblxyXG4gKi9cclxuXHJcbmltcG9ydCB7aXNQcmVzZW50LCBpc0JsYW5rLCBOdW1iZXJXcmFwcGVyLCBSZWdFeHBXcmFwcGVyfSBmcm9tICdAYW5ndWxhci9jb21tb24vc3JjL2ZhY2FkZS9sYW5nJztcclxuaW1wb3J0IHtCYXNlRXhjZXB0aW9ufSBmcm9tICdAYW5ndWxhci9jb21tb24vc3JjL2ZhY2FkZS9leGNlcHRpb25zJztcclxuaW1wb3J0IHtOdW1iZXJGb3JtYXRTdHlsZX0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL3NyYy9mYWNhZGUvaW50bCc7XHJcblxyXG4vLyBTZXJ2aWNlcy5cclxuaW1wb3J0IHtMb2NhbGVOdW1iZXJ9IGZyb20gJy4vbG9jYWxlLW51bWJlcic7XHJcbmltcG9ydCB7SW50bFN1cHBvcnR9IGZyb20gJy4vSW50bC1zdXBwb3J0JztcclxuXHJcbi8qKlxyXG4gKiBMb2NhbGVQYXJzZXIgY2xhc3MuXHJcbiAqIFxyXG4gKiBAYXV0aG9yIFJvYmVydG8gU2ltb25ldHRpXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgTG9jYWxlUGFyc2VyIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHsgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQnVpbGRzIHRoZSByZWd1bGFyIGV4cHJlc3Npb24gZm9yIHRoZSBkZWZhdWx0IGxvY2FsZS5cclxuICAgICAqIFxyXG4gICAgICogQHBhcmFtIGRlZmF1bHRMb2NhbGUgVGhlIGRlZmF1bHQgbG9jYWxlXHJcbiAgICAgKiBAcGFyYW0gZGlnaXRzIFRoZSBkaWdpdCBpbmZvOiB7bWluSW50ZWdlckRpZ2l0c30ue21pbkZyYWN0aW9uRGlnaXRzfS17bWF4RnJhY3Rpb25EaWdpdHN9XHJcbiAgICAgKiBAcmV0dXJuIEEgUmVnRXhwIG9iamVjdFxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgTnVtYmVyUmVnRXhwRmFjdG9yeShkZWZhdWx0TG9jYWxlOiBzdHJpbmcsIGRpZ2l0czogc3RyaW5nKTogUmVnRXhwIHtcclxuXHJcbiAgICAgICAgLy8gR2V0cyBkaWdpdHMuXHJcbiAgICAgICAgdmFyIG1pbkludDogbnVtYmVyID0gMTtcclxuICAgICAgICB2YXIgbWluRnJhY3Rpb246IG51bWJlciA9IDA7XHJcbiAgICAgICAgdmFyIG1heEZyYWN0aW9uOiBudW1iZXIgPSAzO1xyXG4gICAgICAgIHZhciByZTogUmVnRXhwID0gUmVnRXhwV3JhcHBlci5jcmVhdGUoJ14oXFxcXGQrKT9cXFxcLigoXFxcXGQrKShcXFxcLShcXFxcZCspKT8pPyQnKTtcclxuXHJcbiAgICAgICAgaWYgKGlzUHJlc2VudChkaWdpdHMpKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgcGFydHMgPSBSZWdFeHBXcmFwcGVyLmZpcnN0TWF0Y2gocmUsIGRpZ2l0cyk7XHJcblxyXG4gICAgICAgICAgICBpZiAoaXNCbGFuayhwYXJ0cykpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBCYXNlRXhjZXB0aW9uKGAke2RpZ2l0c30gaXMgbm90IGEgdmFsaWQgZGlnaXQgaW5mbyBmb3IgbnVtYmVyYCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGlzUHJlc2VudChwYXJ0c1sxXSkpIHsgIC8vIE1pbiBpbnRlZ2VyIGRpZ2l0cy5cclxuICAgICAgICAgICAgICAgIG1pbkludCA9IE51bWJlcldyYXBwZXIucGFyc2VJbnRBdXRvUmFkaXgocGFydHNbMV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChpc1ByZXNlbnQocGFydHNbM10pKSB7ICAvLyBNaW4gZnJhY3Rpb24gZGlnaXRzLlxyXG4gICAgICAgICAgICAgICAgbWluRnJhY3Rpb24gPSBOdW1iZXJXcmFwcGVyLnBhcnNlSW50QXV0b1JhZGl4KHBhcnRzWzNdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoaXNQcmVzZW50KHBhcnRzWzVdKSkgeyAgLy8gTWF4IGZyYWN0aW9uIGRpZ2l0cy5cclxuICAgICAgICAgICAgICAgIG1heEZyYWN0aW9uID0gTnVtYmVyV3JhcHBlci5wYXJzZUludEF1dG9SYWRpeChwYXJ0c1s1XSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDb252ZXJ0cyBudW1iZXJzICYgc2lnbnMgdG8gVW5pY29kZSBieSBkZWZhdWx0IGxvY2FsZS5cclxuICAgICAgICB2YXIgY29kZXM6IERlY2ltYWxDb2RlID0gbmV3IERlY2ltYWxDb2RlKGRlZmF1bHRMb2NhbGUpO1xyXG5cclxuICAgICAgICB2YXIgbWludXNTaWduOiBzdHJpbmcgPSBjb2Rlcy5taW51c1NpZ247XHJcbiAgICAgICAgdmFyIHplcm86IHN0cmluZyA9IGNvZGVzLm51bWJlcnNbMF07XHJcbiAgICAgICAgdmFyIGRlY2ltYWxTZXBhcmF0b3I6IHN0cmluZyA9IGNvZGVzLmRlY2ltYWxTZXBhcmF0b3I7XHJcbiAgICAgICAgdmFyIG5pbmU6IHN0cmluZyA9IGNvZGVzLm51bWJlcnNbOV07XHJcblxyXG4gICAgICAgIC8vIFBhdHRlcm4gZm9yIDEuMi0yIGRpZ2l0czogL14tP1swLTldezEsfVxcLlswLTldezIsMn0kL1xyXG4gICAgICAgIC8vIFVuaWNvZGUgcGF0dGVybiA9IFwiXlxcdTAwMmQ/W1xcdTAwMzAtXFx1MDAzOV17MSx9XFxcXHUwMDJlW1xcdTAwMzAtXFx1MDAzOV17MiwyfSRcIjtcclxuICAgICAgICB2YXIgcGF0dGVybjogc3RyaW5nO1xyXG4gICAgICAgIGlmIChtaW5GcmFjdGlvbiA+IDAgJiYgbWF4RnJhY3Rpb24gPiAwKSB7XHJcblxyXG4gICAgICAgICAgICBwYXR0ZXJuID0gXCJeXCJcclxuICAgICAgICAgICAgICAgICsgbWludXNTaWduXHJcbiAgICAgICAgICAgICAgICArIFwiP1tcIiArIHplcm8gKyBcIi1cIiArIG5pbmVcclxuICAgICAgICAgICAgICAgICsgXCJde1wiICsgbWluSW50ICsgXCIsfVxcXFxcIlxyXG4gICAgICAgICAgICAgICAgKyBkZWNpbWFsU2VwYXJhdG9yXHJcbiAgICAgICAgICAgICAgICArIFwiW1wiICsgemVybyArIFwiLVwiICsgbmluZVxyXG4gICAgICAgICAgICAgICAgKyBcIl17XCIgKyBtaW5GcmFjdGlvbiArIFwiLFwiICsgbWF4RnJhY3Rpb25cclxuICAgICAgICAgICAgICAgICsgXCJ9JFwiO1xyXG5cclxuICAgICAgICB9IGVsc2UgaWYgKG1pbkZyYWN0aW9uID09IDAgJiYgbWF4RnJhY3Rpb24gPiAwKSB7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBEZWNpbWFsIHNlcGFyYXRvciBpcyBvcHRpb25hbC5cclxuICAgICAgICAgICAgcGF0dGVybiA9IFwiXlwiXHJcbiAgICAgICAgICAgICAgICArIG1pbnVzU2lnblxyXG4gICAgICAgICAgICAgICAgKyBcIj9bXCIgKyB6ZXJvICsgXCItXCIgKyBuaW5lXHJcbiAgICAgICAgICAgICAgICArIFwiXXtcIiArIG1pbkludCArIFwiLH1cXFxcXCJcclxuICAgICAgICAgICAgICAgICsgZGVjaW1hbFNlcGFyYXRvclxyXG4gICAgICAgICAgICAgICAgKyBcIj9bXCIgKyB6ZXJvICsgXCItXCIgKyBuaW5lXHJcbiAgICAgICAgICAgICAgICArIFwiXXtcIiArIG1pbkZyYWN0aW9uICsgXCIsXCIgKyBtYXhGcmFjdGlvblxyXG4gICAgICAgICAgICAgICAgKyBcIn0kXCI7XHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgICAvLyBJbnRlZ2VyIG51bWJlci5cclxuICAgICAgICAgICAgcGF0dGVybiA9IHBhdHRlcm4gPSBcIl5cIlxyXG4gICAgICAgICAgICAgICAgKyBtaW51c1NpZ25cclxuICAgICAgICAgICAgICAgICsgXCI/W1wiICsgemVybyArIFwiLVwiICsgbmluZVxyXG4gICAgICAgICAgICAgICAgKyBcIl17XCIgKyBtaW5JbnQgKyBcIix9JFwiO1xyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgcGF0dGVybiA9IGV2YWwoXCInXCIgKyBwYXR0ZXJuICsgXCInXCIpO1xyXG4gICAgICAgIHZhciByZWdFeHA6IFJlZ0V4cCA9IG5ldyBSZWdFeHAocGF0dGVybik7XHJcblxyXG4gICAgICAgIHJldHVybiByZWdFeHA7XHJcblxyXG4gICAgICAgIC8vIFdvbmRlcmZ1bCwgaXQgd29ya3MhXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQYXJzZXMgYSBzdHJpbmcgYW5kIHJldHVybnMgYSBudW1iZXIgYnkgZGVmYXVsdCBsb2NhbGUuXHJcbiAgICAgKiBcclxuICAgICAqIEBwYXJhbSBzIFRoZSBzdHJpbmcgdG8gYmUgcGFyc2VkXHJcbiAgICAgKiBAcGFyYW0gZGVmYXVsdExvY2FsZSBUaGUgZGVmYXVsdCBsb2NhbGVcclxuICAgICAqIEByZXR1cm4gQSBudW1iZXIuIElmIHRoZSBzdHJpbmcgY2Fubm90IGJlIGNvbnZlcnRlZCB0byBhIG51bWJlciwgcmV0dXJucyBOYU5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIE51bWJlcihzOiBzdHJpbmcsIGRlZmF1bHRMb2NhbGU6IHN0cmluZyk6IG51bWJlciB7XHJcblxyXG4gICAgICAgIGlmIChzID09ICcnIHx8IGRlZmF1bHRMb2NhbGUgPT0gJycgfHwgZGVmYXVsdExvY2FsZSA9PSBudWxsKSByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgdmFyIGNvZGVzOiBEZWNpbWFsQ29kZSA9IG5ldyBEZWNpbWFsQ29kZShkZWZhdWx0TG9jYWxlKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGNvZGVzLnBhcnNlKHMpO1xyXG5cclxuICAgIH1cclxuXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBOdW1iZXJDb2RlIGFic3RyYWN0IHN1cGVyY2xhc3MuXHJcbiAqIFxyXG4gKiBDb252ZXJ0cyBudW1iZXJzIHRvIFVuaWNvZGUgYnkgbG9jYWxlcy5cclxuICogXHJcbiAqIEBhdXRob3IgUm9iZXJ0byBTaW1vbmV0dGlcclxuICovXHJcbmFic3RyYWN0IGNsYXNzIE51bWJlckNvZGUge1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogVW5pY29kZSBmb3IgbnVtYmVycyBmcm9tIDAgdG8gOS5cclxuICAgICAqL1xyXG4gICAgcHVibGljIG51bWJlcnM6IEFycmF5PHN0cmluZz4gPSBbXTtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgZGVmYXVsdExvY2FsZTogc3RyaW5nKSB7XHJcblxyXG4gICAgICAgIGZvciAodmFyIGk6IG51bWJlciA9IDA7IGkgPD0gOTsgaSsrKSB7XHJcblxyXG4gICAgICAgICAgICB0aGlzLm51bWJlcnMucHVzaCh0aGlzLlVuaWNvZGUoaS50b1N0cmluZygpKSk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ2hlY2tzIGZvciBzdXBwb3J0IGZvciBJbnRsLlxyXG4gICAgICAgIGlmIChJbnRsU3VwcG9ydC5OdW1iZXJGb3JtYXQoZGVmYXVsdExvY2FsZSkgPT0gdHJ1ZSkge1xyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlcyBVbmljb2RlIGZvciBudW1iZXJzIGJ5IGRlZmF1bHQgbG9jYWxlLlxyXG4gICAgICAgICAgICBmb3IgKHZhciBpOiBudW1iZXIgPSAwOyBpIDw9IDk7IGkrKykge1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMubnVtYmVyc1tpXSA9IHRoaXMuVW5pY29kZShMb2NhbGVOdW1iZXIuZm9ybWF0KGRlZmF1bHRMb2NhbGUsIGksIE51bWJlckZvcm1hdFN0eWxlLkRlY2ltYWwsICcxLjAtMCcpKTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFBhcnNlcyBhIHN0cmluZyBhbmQgcmV0dXJucyBhIG51bWJlciBieSBkZWZhdWx0IGxvY2FsZS5cclxuICAgICAqIFxyXG4gICAgICogQHBhcmFtIHMgVGhlIHN0cmluZyB0byBiZSBwYXJzZWRcclxuICAgICAqIEByZXR1cm4gQSBudW1iZXJcclxuICAgICAqL1xyXG4gICAgYWJzdHJhY3QgcGFyc2Uoczogc3RyaW5nKTogbnVtYmVyO1xyXG5cclxuICAgIHByb3RlY3RlZCBVbmljb2RlKGM6IHN0cmluZyk6IHN0cmluZyB7XHJcblxyXG4gICAgICAgIHJldHVybiBcIlxcXFx1XCIgKyB0aGlzLkhleEVuY29kZShjLmNoYXJDb2RlQXQoMCkpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgSGV4RW5jb2RlKHZhbHVlOiBudW1iZXIpOiBzdHJpbmcge1xyXG5cclxuICAgICAgICB2YXIgaGV4OiBzdHJpbmcgPSB2YWx1ZS50b1N0cmluZygxNikudG9VcHBlckNhc2UoKTtcclxuICAgICAgICAvLyBXaXRoIHBhZGRpbmcuXHJcbiAgICAgICAgaGV4ID0gXCIwMDAwXCIuc3Vic3RyKDAsIDQgLSBoZXgubGVuZ3RoKSArIGhleDtcclxuXHJcbiAgICAgICAgcmV0dXJuIGhleDtcclxuXHJcbiAgICB9XHJcblxyXG59XHJcblxyXG4vKipcclxuICogRGVjaW1hbENvZGUgY2xhc3MuXHJcbiAqIFxyXG4gKiBDb252ZXJ0cyBudW1iZXJzICYgc2lnbnMgdG8gVW5pY29kZSBieSBsb2NhbGVzLlxyXG4gKiBcclxuICogQGF1dGhvciBSb2JlcnRvIFNpbW9uZXR0aVxyXG4gKi9cclxuY2xhc3MgRGVjaW1hbENvZGUgZXh0ZW5kcyBOdW1iZXJDb2RlIHtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFVuaWNvZGUgZm9yIG1pbnVzIHNpZ24uXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBtaW51c1NpZ246IHN0cmluZztcclxuXHJcbiAgICAvKipcclxuICAgICAqIFVuaWNvZGUgZm9yIGRlY2ltYWwgc2VwYXJhdG9yLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZGVjaW1hbFNlcGFyYXRvcjogc3RyaW5nO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBkZWZhdWx0TG9jYWxlOiBzdHJpbmcpIHtcclxuICAgICAgICBzdXBlcihkZWZhdWx0TG9jYWxlKVxyXG5cclxuICAgICAgICB0aGlzLm1pbnVzU2lnbiA9IHRoaXMuVW5pY29kZShcIi1cIik7XHJcbiAgICAgICAgdGhpcy5kZWNpbWFsU2VwYXJhdG9yID0gdGhpcy5Vbmljb2RlKFwiLlwiKTtcclxuXHJcbiAgICAgICAgLy8gQ2hlY2tzIGZvciBzdXBwb3J0IGZvciBJbnRsLlxyXG4gICAgICAgIGlmIChJbnRsU3VwcG9ydC5OdW1iZXJGb3JtYXQoZGVmYXVsdExvY2FsZSkgPT0gdHJ1ZSkge1xyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlcyBVbmljb2RlIGZvciBzaWducyBieSBkZWZhdWx0IGxvY2FsZS5cclxuICAgICAgICAgICAgdmFyIHZhbHVlOiBudW1iZXIgPSAtMC45OyAvLyBSZWZlcmVuY2UgdmFsdWUuXHJcbiAgICAgICAgICAgIHZhciBsb2NhbGVWYWx1ZTogc3RyaW5nID0gTG9jYWxlTnVtYmVyLmZvcm1hdChkZWZhdWx0TG9jYWxlLCB2YWx1ZSwgTnVtYmVyRm9ybWF0U3R5bGUuRGVjaW1hbCwgJzEuMS0xJyk7XHJcblxyXG4gICAgICAgICAgICAvLyBDaGVja3MgVW5pY29kZSBjaGFyYWN0ZXIgJ1JJR0hULVRPLUxFRlQgTUFSSycgKFUrMjAwRikuXHJcbiAgICAgICAgICAgIHZhciBpbmRleDogbnVtYmVyO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5Vbmljb2RlKGxvY2FsZVZhbHVlLmNoYXJBdCgwKSkgIT0gXCJcXFxcdTIwMEZcIikge1xyXG4gICAgICAgICAgICAgICAgLy8gTGVmdCB0byByaWdodC5cclxuICAgICAgICAgICAgICAgIGluZGV4ID0gMDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIFJpZ2h0IHRvIGxlZnQuXHJcbiAgICAgICAgICAgICAgICBpbmRleCA9IDE7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMubWludXNTaWduID0gdGhpcy5Vbmljb2RlKGxvY2FsZVZhbHVlLmNoYXJBdChpbmRleCkpO1xyXG4gICAgICAgICAgICB0aGlzLmRlY2ltYWxTZXBhcmF0b3IgPSB0aGlzLlVuaWNvZGUobG9jYWxlVmFsdWUuY2hhckF0KGluZGV4ICsgMikpO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHBhcnNlKHM6IHN0cmluZyk6IG51bWJlciB7XHJcblxyXG4gICAgICAgIC8vIFNwbGl0cyB0aGUgU3RyaW5nIG9iamVjdCBpbnRvIGFuIGFycmF5IG9mIGNoYXJhY3RlcnMuXHJcbiAgICAgICAgdmFyIGNoYXJhY3RlcnM6IEFycmF5PHN0cmluZz4gPSBzLnNwbGl0KCcnKTtcclxuXHJcbiAgICAgICAgLy8gQnVpbGRzIHRoZSB2YWx1ZS5cclxuICAgICAgICB2YXIgdmFsdWU6IHN0cmluZyA9IFwiXCI7XHJcblxyXG4gICAgICAgIGZvciAobGV0IGNoYXIgb2YgY2hhcmFjdGVycykge1xyXG5cclxuICAgICAgICAgICAgdmFyIGNoYXJDb2RlOiBzdHJpbmcgPSB0aGlzLlVuaWNvZGUoY2hhcik7XHJcblxyXG4gICAgICAgICAgICAvLyBUcnkgdG8gbG9vayBmb3IgdGhlIGNoYXIgY29kZSBpbiBudW1iZXJzIGFuZCBzaWducy5cclxuICAgICAgICAgICAgdmFyIGluZGV4OiBudW1iZXIgPSB0aGlzLm51bWJlcnMuaW5kZXhPZihjaGFyQ29kZSk7XHJcbiAgICAgICAgICAgIGlmIChpbmRleCAhPSAtMSkge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhbHVlICs9IGluZGV4O1xyXG5cclxuICAgICAgICAgICAgfSBlbHNlIGlmIChjaGFyQ29kZSA9PSB0aGlzLm1pbnVzU2lnbikge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhbHVlICs9IFwiLVwiO1xyXG5cclxuICAgICAgICAgICAgfSBlbHNlIGlmIChjaGFyQ29kZSA9PSB0aGlzLmRlY2ltYWxTZXBhcmF0b3IpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YWx1ZSArPSBcIi5cIjtcclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7IHJldHVybiBOYU47IH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcGFyc2VGbG9hdCh2YWx1ZSk7XHJcblxyXG4gICAgfVxyXG5cclxufVxyXG4iXX0=